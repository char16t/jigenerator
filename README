Version 3.0

program := (rule)* (termdef)* (astdef)*

rule    := nonterm EQ expr SEMI
expr    := (expr2)* (LINE expr)*
expr2   := expr3 | STAR LPAREN expr3 (expr)* RPAREN
expr3   := atom | LPAREN expr RPAREN
atom    := nonterm | TERM
nonterm := NONTERM (NAME | EMPTY)

termdef     := TERM EQ termexpr SEMI
termexpr    := (termexpr2)* (LINE termexpr)*
termexpr2   := termexpr3 | STAR LPAREN termexpr3 (termexpr)* RPAREN
termexpr3   := termatom | LPAREN termexpr RPAREN
termatom    := SQ <any symbols except single quote> SQ

astdef := ASTNAME LPAREN INTEGER RPAREN SEMI

SQ  := '\''
ASTNAME := '@' ('a'..'z' | 'A'..'Z')*
LPAREN  := '('
RPAREN  := ')'
SEMI    := ';'
NAME    := '[' ('a'..'z' | 'A'..'Z')* ']'
COMMA   := ','
EMPTY   := ''
WORD    := ('a'..'z' | 'A'..'Z')*
INTEGER := ('0'|'1'|'2'|'3'|'4'|'5'|'6'|'7'|'8'|'9') ('0'|'1'|'2'|'3'|'4'|'5'|'6'|'7'|'8'|'9')*


